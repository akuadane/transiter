// Code generated by sqlc. DO NOT EDIT.
// source: feed_queries.sql

package db

import (
	"context"
	"database/sql"
)

const deleteFeed = `-- name: DeleteFeed :exec
DELETE FROM feed WHERE pk = $1
`

func (q *Queries) DeleteFeed(ctx context.Context, pk int32) error {
	_, err := q.db.ExecContext(ctx, deleteFeed, pk)
	return err
}

const insertFeed = `-- name: InsertFeed :exec
INSERT INTO feed
    (id, system_pk, auto_update_enabled, auto_update_period, config)
VALUES
    ($1, $2, $3, 
     $4, $5)
`

type InsertFeedParams struct {
	ID                string
	SystemPk          int32
	AutoUpdateEnabled bool
	AutoUpdatePeriod  sql.NullInt32
	Config            string
}

func (q *Queries) InsertFeed(ctx context.Context, arg InsertFeedParams) error {
	_, err := q.db.ExecContext(ctx, insertFeed,
		arg.ID,
		arg.SystemPk,
		arg.AutoUpdateEnabled,
		arg.AutoUpdatePeriod,
		arg.Config,
	)
	return err
}

const listAutoUpdateFeedsForSystem = `-- name: ListAutoUpdateFeedsForSystem :many
SELECT feed.id, feed.auto_update_period
FROM feed
    INNER JOIN system ON system.pk = feed.system_pk
WHERE feed.auto_update_enabled
    AND system.id = $1
`

type ListAutoUpdateFeedsForSystemRow struct {
	ID               string
	AutoUpdatePeriod sql.NullInt32
}

func (q *Queries) ListAutoUpdateFeedsForSystem(ctx context.Context, systemID string) ([]ListAutoUpdateFeedsForSystemRow, error) {
	rows, err := q.db.QueryContext(ctx, listAutoUpdateFeedsForSystem, systemID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []ListAutoUpdateFeedsForSystemRow
	for rows.Next() {
		var i ListAutoUpdateFeedsForSystemRow
		if err := rows.Scan(&i.ID, &i.AutoUpdatePeriod); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const updateFeed = `-- name: UpdateFeed :exec
UPDATE feed
SET auto_update_enabled = $1, 
    auto_update_period = $2, 
    config = $3
WHERE pk = $4
`

type UpdateFeedParams struct {
	AutoUpdateEnabled bool
	AutoUpdatePeriod  sql.NullInt32
	Config            string
	FeedPk            int32
}

func (q *Queries) UpdateFeed(ctx context.Context, arg UpdateFeedParams) error {
	_, err := q.db.ExecContext(ctx, updateFeed,
		arg.AutoUpdateEnabled,
		arg.AutoUpdatePeriod,
		arg.Config,
		arg.FeedPk,
	)
	return err
}
